"use strict";function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var e=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.ERROR_MISSING_CALLBACK="Callback function is missing!",this._slice=Array.prototype.slice,this._listeners=[],this._dispatchCount=0}var i,n;return i=e,(n=[{key:"_sort",value:function(t){t.sort((function(t,e){return t=t.p,(e=e.p)<t?1:e>t?-1:0}))}},{key:"add",value:function(t,e,i,n){if(!t)throw this.ERROR_MISSING_CALLBACK;i=i||0;for(var r,s,l,a=this._listeners,c=a.length;c--;)if((r=a[c]).f===t&&r.c===e)return!1;"function"==typeof i&&(s=i,i=n,l=4),a.unshift({f:t,c:e,p:i,r:s||t,a:this._slice.call(arguments,l||3),j:0}),this._sort(a)}},{key:"addOnce",value:function(t,e,i,n){if(!t)throw this.ERROR_MISSING_CALLBACK;var r=this,s=function(){return r.remove.call(r,t,e),t.apply(e,r._slice.call(arguments,0))};1===(n=this._slice.call(arguments,0)).length&&n.push(void 0),n.splice(2,0,s),this.add.apply(r,n)}},{key:"remove",value:function(t,e){if(!t)return this._listeners.length=0,!0;for(var i,n=this._listeners,r=n.length;r--;)if((i=n[r]).f===t&&(!e||i.c===e))return i.j=0,n.splice(r,1),!0;return!1}},{key:"dispatch",value:function(t){t=this._slice.call(arguments,0),this._dispatchCount+=1;for(var e,i,n=this._dispatchCount,r=this._listeners,s=r.length;s--;)if((e=r[s])&&e.j<n&&(e.j=n,!1===e.r.apply(e.c,e.a.concat(t)))){i=e;break}for(s=(r=this._listeners).length;s--;)r[s].j=0;return i}}])&&t(i.prototype,n),e}();module.exports=e;
